@model IEnumerable<ConsertaPraMim.Application.DTOs.ProposalDto>
@{
    ViewData["Title"] = "Minhas Propostas";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h1 class="h3 fw-bold">Minhas Propostas</h1>
            <p class="text-muted">Acompanhe o status de todas as propostas enviadas aos clientes.</p>
        </div>
    </div>

    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light text-muted small text-uppercase">
                        <tr>
                            <th class="px-4 py-3">Data Envio</th>
                            <th>Pedido</th>
                            <th>Valor Estimado</th>
                            <th>Status</th>
                            <th class="text-end px-4">Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Any())
                        {
                            <tr>
                                <td colspan="5" class="text-center py-5">
                                    <div class="py-4">
                                        <i class="fas fa-paper-plane fa-4x text-light mb-3"></i>
                                        <h5 class="text-muted">Nenhuma proposta enviada</h5>
                                        <p class="text-muted small">Comece procurando novos pedidos no seu radar.</p>
                                        <a asp-controller="ServiceRequests" asp-action="Index" class="btn btn-primary mt-2">Explorar Pedidos</a>
                                    </div>
                                </td>
                            </tr>
                        }
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td class="px-4">
                                    <span class="text-dark">@item.CreatedAt.ToString("dd/MM/yyyy")</span><br/>
                                    <small class="text-muted">@item.CreatedAt.ToString("HH:mm")</small>
                                </td>
                                <td>
                                    <div class="fw-semibold text-dark">Serviço #@item.RequestId.ToString().Substring(0,8)</div>
                                    <small class="text-muted">Clique em detalhes para ver o pedido original</small>
                                </td>
                                <td>
                                    <span class="fw-bold">R$ @(item.EstimatedValue?.ToString("N2") ?? "---")</span>
                                </td>
                                <td>
                                    @if (item.Accepted)
                                    {
                                        <span class="badge bg-success shadow-sm rounded-pill px-3">
                                            <i class="fas fa-check-circle me-1"></i> Aceita
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-warning text-dark shadow-sm rounded-pill px-3">
                                            <i class="fas fa-clock me-1"></i> Pendente
                                        </span>
                                    }
                                </td>
                                <td class="text-end px-4">
                                    <a asp-controller="ServiceRequests" asp-action="Details" asp-route-id="@item.RequestId" class="btn btn-outline-primary btn-sm rounded-pill px-3">Ver Detalhes</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
