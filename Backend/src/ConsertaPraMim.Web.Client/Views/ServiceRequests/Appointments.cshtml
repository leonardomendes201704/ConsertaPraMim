@model IReadOnlyList<ConsertaPraMim.Web.Client.Models.ClientAppointmentListItemViewModel>
@{
    ViewData["Title"] = "Agendamentos";
    var initialAppointmentsJson = System.Text.Json.JsonSerializer.Serialize(
        Model.Select(item => new
        {
            appointmentId = item.AppointmentId,
            serviceRequestId = item.ServiceRequestId,
            providerId = item.ProviderId,
            providerName = item.ProviderName,
            category = item.Category,
            description = item.Description,
            street = item.Street,
            city = item.City,
            status = item.Status,
            windowStartUtc = item.WindowStartUtc,
            windowEndUtc = item.WindowEndUtc,
            createdAtUtc = item.CreatedAtUtc,
            updatedAtUtc = item.UpdatedAtUtc,
            noShowRiskScore = item.NoShowRiskScore,
            noShowRiskLevel = item.NoShowRiskLevel,
            noShowRiskCalculatedAtUtc = item.NoShowRiskCalculatedAtUtc
        }));
}

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 fw-bold mb-1">Agendamentos</h1>
            <p class="text-muted mb-0">Acompanhe os atendimentos futuros e o historico sem recarregar a pagina.</p>
        </div>
        <a asp-action="Index" class="btn btn-outline-primary rounded-pill px-4">
            <i class="fas fa-list-ul me-2"></i>Meus pedidos
        </a>
    </div>

    <div id="appointments-empty" class="card border-0 shadow-sm p-5 text-center bg-white rounded-4 d-none">
        <div class="mb-3 text-muted">
            <i class="fas fa-calendar-times fa-4x opacity-25"></i>
        </div>
        <h5>Voce ainda nao possui agendamentos</h5>
        <p class="text-muted mb-4">Assim que um horario for marcado, ele aparecera aqui.</p>
        <a asp-action="Index" class="btn btn-primary rounded-pill px-4">Ver meus pedidos</a>
    </div>

    <div id="appointments-content" class="row g-4">
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100 rounded-4">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="h5 fw-bold mb-0">Proximos</h4>
                        <span id="upcoming-count" class="badge bg-primary-subtle text-primary rounded-pill px-3">0</span>
                    </div>
                    <div id="upcoming-list" class="d-grid gap-3"></div>
                </div>
            </div>
        </div>

        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100 rounded-4">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="h5 fw-bold mb-0">Historico</h4>
                        <span id="past-count" class="badge bg-secondary-subtle text-secondary rounded-pill px-3">0</span>
                    </div>
                    <div id="past-list" class="d-grid gap-3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    window.serviceRequestAppointmentsConfig = {
        initialAppointments: @Html.Raw(initialAppointmentsJson)
    };
</script>
<script src="~/js/views/service-requests/appointments.js" asp-append-version="true"></script>
}
